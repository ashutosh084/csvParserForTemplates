(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const r of e)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&t(o)}).observe(document,{childList:!0,subtree:!0});function c(e){const r={};return e.integrity&&(r.integrity=e.integrity),e.referrerPolicy&&(r.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?r.credentials="include":e.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function t(e){if(e.ep)return;e.ep=!0;const r=c(e);fetch(e.href,r)}})();const E=function(s){document.getElementById("fields").innerText=s},w=function(s){document.getElementById("fieldCount").innerText=s},v=function(){return document.getElementById("fields").innerText},F=function(){return document.getElementById("fieldCount").innerText};function C(s,n,c){var t=new Blob([s],{type:c}),e=document.createElement("a");e.href=URL.createObjectURL(t),e.download=n,document.body.appendChild(e),e.click(),document.body.removeChild(e)}function y(s,n=!1){const c=new Set,t=new Map;s.forEach(i=>{i.trim().split(n?/[,|]/:",").forEach(f=>{c.add(f.split(":")[0]),t.set(f.split(":")[0],(t.get(f.split(":")[0])||0)+1)})});const r=Array.from(c).map(i=>[i]),o=["Fields"].concat(r.map(i=>i.join(","))).join(`
`);E(o);const a=[...t.entries()].sort((i,u)=>u[1]-i[1]),d=["Fields,Counts"].concat(a.map(i=>i.join(","))).join(`
`);w(d)}function b(s){const n=s.map(o=>o.split("	")),c=new Map;n.forEach(o=>{const a=o[0],l=o[1];c[a]?c[a].push(l):c[a]=[l]});const t=new Map;Object.keys(c).forEach(o=>{const a=c[o],l=new Map;["WorkList","Open Items","Invoices","Applied Payments","Email Inbox"].some(d=>o.toLocaleLowerCase().includes(d.toLocaleLowerCase()))?a.forEach(d=>{var i,u,f,h;try{const m=(i=JSON.parse(d))==null?void 0:i.searchParams,p=(h=(f=(u=m==null?void 0:m.trim())==null?void 0:u.replace(/^\[/g,""))==null?void 0:f.replace(/\]$/g,""))==null?void 0:h.split(",");p==null||p.forEach(g=>{l.set(g,(l.get(g)||0)+1)})}catch(m){console.log(m)}}):console.log("Invalid search type",o),t[o]=l});const e={};Object.keys(t).forEach(o=>{let a=[];const d=[...t[o].entries()].sort((i,u)=>u[1]-i[1]);a=a.concat(["Fields,Counts"].concat(d.map(i=>i.join(",")))),e[o]=a.join(`
`)});let r="";Object.keys(e).forEach(o=>{r+=`<b>${o}</b>
${e[o]}

`}),E(r),w("")}const I=function(){const s=document.getElementById("sourceFields").value,n=[];s.split(`
`).forEach(c=>{const t=c.replace(/\/\//g,"/");n.push(t)}),document.getElementById("gridLayout").checked?y(n):document.getElementById("query").checked?b(n):document.getElementById("advSearchLayout").checked||document.getElementById("detailsLayout").checked?y(n,!0):alert("Please select a radio button")};function L(s){const n=document.getElementById("fileNamePrefix").value;if(s==0){const c=v();let t="fields.csv";n&&(t=n+"_"+t),C(c,t,"text/csv")}else if(s==1){const c=F();let t="fieldCount.csv";n&&(t=n+"_"+t),C(c,t,"text/csv")}else window.alert("error")}document.getElementById("gridLayout").checked=!0;window.processCsv=I;window.createAndDownloadFile=L;
